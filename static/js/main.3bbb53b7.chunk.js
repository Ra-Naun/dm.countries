(this["webpackJsonpdm.countries"]=this["webpackJsonpdm.countries"]||[]).push([[0],{31:function(e,t,r){},32:function(e,t,r){},38:function(e,t,r){},39:function(e,t,r){},42:function(e,t,r){},43:function(e,t,r){},44:function(e,t,r){},45:function(e,t,r){},46:function(e,t,r){},47:function(e,t,r){},48:function(e,t,r){},49:function(e,t,r){},50:function(e,t,r){},51:function(e,t,r){"use strict";r.r(t);var n=r(1),c=r.n(n),o=r(7),s=r.n(o),a=(r(31),r(32),r(3)),i=r(12),u=r(4),l=r(10),d=(r(37),r(18)),h=(r(38),r(39),r(0)),f=function(e){var t=e.isChecked,r=e.filterID,n=e.title,c=e.toggleChecked;return Object(h.jsxs)("label",{className:"label-for-checkbox",children:[Object(h.jsx)("input",{checked:t,onChange:function(){return c(r)},type:"checkbox",className:"checkbox",name:"checkbox"}),Object(h.jsx)("span",{className:"checkbox__style"}),Object(h.jsx)("p",{className:"checkbox__title",children:n})]})},j=function(e){var t=e.search,r=e.classes,c=e.role,o=Object(n.useState)(""),s=Object(l.a)(o,2),a=s[0],j=s[1],b=Object(n.useState)(!1),m=Object(l.a)(b,2),v=m[0],O=m[1],C=Object(n.useState)({byName:!0,byCode:!0}),y=Object(l.a)(C,2),p=y[0],x=y[1],_=function(e){x(Object(u.a)(Object(u.a)({},p),{},Object(i.a)({},e,!p[e])))};return Object(n.useEffect)((function(){v&&d.a.warn("\u0422\u043e\u043b\u044c\u043a\u043e \u043e\u0431\u0449\u0435\u043f\u0440\u0438\u043d\u044f\u0442\u043e\u0435 \u0430\u043d\u0433\u043b\u043e\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435")}),[v]),Object(h.jsxs)("form",{action:"",className:"search-form "+r,children:[Object(h.jsxs)("div",{className:"search-form__request",children:[Object(h.jsx)("input",{className:"search-form__input ".concat(v&&"isError"),type:"search",id:"search-country",name:"q",placeholder:c,value:a,"aria-label":c,onChange:function(e){var t=e.target.value;j(t);/^[a-zA-Z]+$/.test(t)||0===t.length?O(!1):O(!0)}}),Object(h.jsx)("button",{className:"search-form__search-btn",title:"search...",onClick:function(e){e.preventDefault(),!v&&a.length>0?t(a,p):d.a.error("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435")}})]}),Object(h.jsxs)("div",{className:"search-form__checkboxes",children:[Object(h.jsx)(f,{isChecked:p.byName,filterID:"byName",toggleChecked:_,title:"By name"}),Object(h.jsx)(f,{isChecked:p.byCode,filterID:"byCode",toggleChecked:_,title:"By code"})]})]})},b=r(5),m=r(6),v=r.n(m),O=r(9),C="@@SearchedCountries/COUNTRIES_REQUEST",y="@@SearchedCountries/COUNTRIES_SUCCESS",p="@@SearchedCountries/COUNTRIES_FAIL",x="@@SearchedCountries/CLEAR_RESULTS",_="@@selectedCountry/SET_SELECTED_COUNTRY",g="@@selectedCountry/RESET_SELECTED_COUNTRY",S="@@FavoriteCountries/PUSH_FAVORITE_COUNTRY",N="@@FavoriteCountries/REMOVE_FAVORITE_COUNTRY",F="@@CountriesCach/UPDATE_CACHE",E=function(){var e=Object(O.a)(v.a.mark((function e(t,r){var n,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(t).concat(r));case 3:return n=e.sent,e.next=6,n.json();case 6:if(400!==(c=e.sent).status&&404!==c.status){e.next=9;break}throw new Error(c.message);case 9:return e.abrupt("return",[c]);case 12:return e.prev=12,e.t0=e.catch(0),console.log("error: ",e.t0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,r){return e.apply(this,arguments)}}(),k=function(e){var t=[];return e.forEach((function(e){var r=e.alpha3Code||e.code,n=!0;t.forEach((function(e){(e.alpha3Code||e.code)===r&&(n=!1)})),n&&t.push(e)})),t},R=function(e){var t=[];return e.forEach((function(e){var r={code:e.alpha3Code||e.code,name:e.name,flag:e.flag,languages:e.languages,border_countries:e.borders};t.push(r)})),t},T=function(e){var t=Object(b.a)(e);return t.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),t},B=function(e){return function(t){return function(r){return r({type:e,payload:t})}}},w=B(F),I=B(C),U=B(y),L=B(p),D=(B("@@SearchedCountries/SET_FILTERS"),B(x)),z=function(){var e=Object(O.a)(v.a.mark((function e(t,r){var n,c,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],e.t0=r.byCode,!e.t0){e.next=6;break}return e.next=5,E("https://restcountries.eu/rest/v2/alpha/",t);case 5:e.t0=e.sent;case 6:if(c=e.t0,n=[].concat(Object(b.a)(n),Object(b.a)(c||[])),e.t1=r.byName,!e.t1){e.next=13;break}return e.next=12,E("https://restcountries.eu/rest/v2/name/",t);case 12:e.t1=e.sent;case 13:return o=e.t1,n=[].concat(Object(b.a)(n),Object(b.a)(o[0]||[])),n=k(n),n=R(n),n=T(n),e.abrupt("return",n);case 19:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),A=Object(a.b)(null,(function(e){return{search:function(t,r){return e(function(e,t){return function(){var r=Object(O.a)(v.a.mark((function r(n){var c,o;return v.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n(I()),r.next=3,z(e,t);case 3:(c=r.sent).length>0?(n(w(c)),o=[],c.forEach((function(e){o.push({code:e.code})})),n(U(o))):n(L("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0430\u0439\u0442\u0438..."));case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}(t,r))}}}))((function(e){var t=e.search;return Object(h.jsx)(j,{search:t,classes:"search-countries",role:"Search countries"})})),V=(r(42),r(43),r(44),function(){return Object(h.jsx)("div",{className:"spinner"})}),J=B(S),M=B(N),P=(r(45),function(e){var t=e.code,r=e.pushToFavorite,n=e.removeFromFavorite,c=e.isFavorite;return Object(h.jsx)("div",{className:"favorite-icon ".concat(c(t)&&"active"),onClick:function(){c(t)?window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0443 \u0438\u0437 \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d\u043d\u044b\u0445?")&&n(t):r(t)},children:c(t)?"\u2605":"\u2606"})});function Y(e,t){var r=e.countriesCache.filter((function(e){return e.code===t}))[0];return r||{code:t,needLoaded:!0}}function q(e){var t=e.selectedCountry.code;if(!!t){var r=Y(e,t),n=r.border_countries.map((function(t){return Y(e,t.code||t)}));return r.border_countries=n,r}return null}function H(e){var t=e.favoriteCountries,r=[];return[].forEach.call(t,(function(t){if(!!t.code){var n=Y(e,t.code);r.push(n)}})),r}function Q(e){var t=e.searchedCountries.countries,r=Object(u.a)({},e.searchedCountries);return r.countries=t.map((function(t){return Y(e,t.code)})),r}function Z(e,t){var r=!1;return e.favoriteCountries.forEach((function(e){e.code===t&&(r=!0)})),r}var $=Object(a.b)((function(e){return{isFavorite:function(e){return function(t){return Z(e,t)}}(e),shouldComponentUpdate:e.favoriteCountries}}),(function(e){return{pushToFavorite:function(t){return e(J(t))},removeFromFavorite:function(t){return e(M(t))}}}))((function(e){var t=e.pushToFavorite,r=e.removeFromFavorite,n=e.isFavorite,c=e.code;return Object(h.jsx)(P,{code:c,pushToFavorite:t,removeFromFavorite:r,isFavorite:n})})),G=function(e){var t=e.lazzyLoadByCode,r=e.country,n=e.setSelectedCountryByCode,c=e.index,o=e.clearSearchResults,s=e.isClearSearchResults,a=void 0!==s&&s,i=r.flag,u=r.name,l=r.code,d=r.needLoaded;d&&t(l);var f=Object(h.jsxs)("li",{className:"country-short-info",children:[Object(h.jsxs)("div",{className:"country-short-info__wrapper",children:[Object(h.jsxs)("div",{className:"country-short-info__wrapper",onClick:function(){n(l),a&&o()},children:[Object(h.jsxs)("p",{className:"country-short-info__num",children:["\u27a3 ",c+1]}),Object(h.jsx)("img",{height:"15px",className:"country-short-info__flag",src:i,alt:"flag"}),Object(h.jsx)("p",{className:"country-short-info__name",children:u})]}),Object(h.jsx)("div",{className:"country-short-info__favorite",children:Object(h.jsx)($,{code:l})})]}),Object(h.jsx)("hr",{className:"short-country-hr"})]});return d?Object(h.jsxs)("li",{className:"country-short-info",children:[Object(h.jsxs)("div",{className:"country-short-info__wrapper",children:[Object(h.jsxs)("p",{className:"country-short-info__num",children:["\u27a3 ",c+1]}),Object(h.jsx)("p",{className:"country-short-info__name",children:l}),Object(h.jsx)(V,{})]}),Object(h.jsx)("hr",{className:"short-country-hr"})]}):f},K=Object(a.b)(null,(function(e){return{lazzyLoadByCode:function(t){return e(function(e){return function(){var t=Object(O.a)(v.a.mark((function t(r){var n,c;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={byName:!1,byCode:!0},t.next=3,z(e,n);case 3:c=t.sent,r(w(c));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},clearSearchResults:function(){return e(D())}}}))((function(e){var t=e.lazzyLoadByCode,r=e.country,n=e.setSelectedCountryByCode,c=e.index,o=e.clearSearchResults,s=e.isClearSearchResults;return Object(h.jsx)(G,{lazzyLoadByCode:t,country:r,setSelectedCountryByCode:n,index:c,clearSearchResults:o,isClearSearchResults:s})})),W=function(e){var t=e.selectedCountry,r=e.setSelectedCountryByCode,n=(e.resetSelectedCountry,t.flag),c=t.name,o=t.code,s=t.languages,a=t.border_countries,i=Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("img",{height:"15px",className:"country-information__flag",src:n,alt:"flag"}),Object(h.jsx)("p",{className:"country-information__name",children:c}),Object(h.jsx)("p",{className:"country-information__code",children:"ISO 3166-1 alpha-3:  ".concat(o)}),Object(h.jsxs)("ol",{className:"country-information__languages",children:[Object(h.jsx)("p",{className:"country-information__languages-title",children:"\u042f\u0437\u044b\u043a\u0438:"}),s.map((function(e){return Object(h.jsx)("li",{className:"country-information__lang",children:"\u2022 ".concat(e.name)},e.name)}))]}),Object(h.jsxs)("details",{className:"border-countries",children:[Object(h.jsxs)("summary",{className:"border-countries__summary",children:["C\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0430\u043d\u0438\u0447\u043d\u044b\u0445 \u0441\u0442\u0440\u0430\u043d ","[".concat(a.length,"]")]}),Object(h.jsx)("ol",{className:"border-countries_list",children:a.map((function(e,t){var n=e.name||e.code;return Object(h.jsx)(K,{country:e,index:t,setSelectedCountryByCode:r,isClearSearchResults:!0},n)}))})]}),Object(h.jsx)("div",{className:"country-information__favorite",children:Object(h.jsx)($,{code:o})})]});return Object(h.jsxs)("div",{className:"country-information",children:[Object(h.jsx)("p",{className:"country-information__title title",children:"\ud83d\udd2d Country information:"}),i]})},X=B(_),ee=B(g),te=Object(a.b)((function(e){return{selectedCountry:q(e),shouldComponentUpdate:e.countriesCache}}),(function(e){return{setSelectedCountryByCode:function(t){return e(X(t))},resetSelectedCountry:function(){return e(ee())}}}))((function(e){var t=e.selectedCountry,r=e.setSelectedCountryByCode,n=e.resetSelectedCountry;e.shouldComponentUpdate;return!!(null===t||void 0===t?void 0:t.code)&&Object(h.jsx)(W,{selectedCountry:t,setSelectedCountryByCode:r,resetSelectedCountry:n})})),re=(r(46),r(47),function(e){var t=e.searchedCountries,r=e.setSelectedCountryByCode,c=e.resetSelectedCountry,o=e.clearSearchResults,s=t.isFetching,a=t.error,i=t.countries;Object(n.useEffect)((function(){1!==i.length&&c()}),[s]);var u=Object(h.jsx)("ol",{className:"search-results__countries",children:i.map((function(e,t){return Object(h.jsx)(K,{country:e,index:t,setSelectedCountryByCode:r},e.code)}))}),l=Object(h.jsx)("div",{className:"search-results__wrapper-error",children:Object(h.jsx)("p",{className:"search-results__error",children:a})}),d=Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"search-results__fetching",children:Object(h.jsx)(V,{})})}),f=s?d:a?l:u;return 1===i.length&&(r(i[0].code),o()),Object(h.jsxs)("div",{className:"search-results",children:[Object(h.jsxs)("p",{className:"search-results__title title",children:["\ud83d\udd0e Search results ","["+i.length+"]",":"]}),f]})}),ne=Object(a.b)((function(e){return{searchedCountries:Q(e)}}),(function(e){return{setSelectedCountryByCode:function(t){return e(X(t))},resetSelectedCountry:function(){return e(ee())},clearSearchResults:function(){return e(D())}}}))((function(e){var t=e.searchedCountries,r=e.setSelectedCountryByCode,n=e.resetSelectedCountry,c=e.clearSearchResults,o=t.isFetching,s=t.error;return(t.countries.length||s||o)&&Object(h.jsx)(re,{searchedCountries:t,setSelectedCountryByCode:r,resetSelectedCountry:n,clearSearchResults:c})})),ce=function(){return Object(h.jsxs)("div",{className:"main-content",children:[Object(h.jsx)("p",{className:"main-content__title title",children:"Main content:"}),Object(h.jsx)(te,{}),Object(h.jsx)(ne,{})]})},oe=(r(48),r(49),function(e){var t=e.favCountries,r=e.setSelectedCountryByCode,c=e.pushToFavorite,o=(e.removeFromFavorite,e.isFavorite),s=Object(n.useState)(!1),a=Object(l.a)(s,2),i=a[0],u=a[1];Object(n.useEffect)((function(){var e,t,r=(null===(e=localStorage.getItem("favCountries"))||void 0===e?void 0:e.split(","))||[];0===(null===(t=r[0])||void 0===t?void 0:t.length)||r.forEach((function(e){var t=JSON.parse(e);o(t.code)||c(t.code)})),u(!0)}),[]),Object(n.useEffect)((function(){var e=t.map((function(e){return JSON.stringify({code:e.code})}));i&&localStorage.setItem("favCountries",e||[])}),[t]);var d=Object(h.jsx)("ol",{className:"favorite-countries_list",children:t.map((function(e,t){var n=e.name||e.code;return Object(h.jsx)(K,{country:e,index:t,setSelectedCountryByCode:r,isClearSearchResults:!0},n)}))}),f=Object(h.jsx)("div",{className:"my-favorites__nodata",children:Object(h.jsx)("p",{className:"my-favorites__message",children:"\u0412\u044b \u0435\u0449\u0435 \u043d\u0435 \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043d\u0438 \u043e\u0434\u043d\u0443 \u0441\u0442\u0440\u0430\u043d\u0443..."})}),j=t.length?d:f;return Object(h.jsxs)("div",{className:"my-favorites",children:[Object(h.jsx)("p",{className:"my-favorites__title title",children:"\u2605 My favorites:"}),j]})}),se=Object(a.b)((function(e){return{isFavorite:function(e){return function(t){return Z(e,t)}}(e),favCountries:H(e),shouldComponentUpdate:e.favoriteCountries}}),(function(e){return{setSelectedCountryByCode:function(t){return e(X(t))},pushToFavorite:function(t){return e(J(t))},removeFromFavorite:function(t){return e(M(t))}}}))((function(e){var t=e.favCountries,r=e.setSelectedCountryByCode,n=e.pushToFavorite,c=e.removeFromFavorite,o=e.isFavorite;e.shouldComponentUpdate;return Object(h.jsx)(oe,{favCountries:t,setSelectedCountryByCode:r,pushToFavorite:n,removeFromFavorite:c,isFavorite:o})})),ae=Object(a.b)((function(e){var t=e.searchedCountries,r=t.isFetching,n=t.error,c=t.countries;return{isVisibleCountryInformation:!!e.selectedCountry.code,isVisibleSearchResults:c.length>0||n||r}}),null)((function(e){var t=e.isVisibleCountryInformation,r=e.isVisibleSearchResults;return(t||r)&&Object(h.jsx)(ce,{})})),ie=function(){return Object(h.jsxs)("main",{className:"body container",children:[Object(h.jsxs)("div",{className:"search-block",children:[Object(h.jsx)(A,{}),Object(h.jsx)(ae,{})]}),Object(h.jsx)(se,{})]})},ue=r.p+"static/media/logo.6ce24c58.svg",le=(r(50),function(){return Object(h.jsxs)("header",{className:"app__header",children:[Object(h.jsx)("img",{className:"app__logo",src:ue,alt:"logo"}),Object(h.jsx)("p",{className:"app__title title",children:"Search countries"})]})}),de=r(21),he=r(22),fe=r(26),je=r(25),be=function(e){Object(fe.a)(r,e);var t=Object(je.a)(r);function r(e){var n;return Object(de.a)(this,r),(n=t.call(this,e)).state={hasError:!1},n}return Object(he.a)(r,[{key:"componentDidCatch",value:function(e,t){console.log(t)}},{key:"render",value:function(){return this.state.hasError?Object(h.jsx)("h1",{children:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a."}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),r}(c.a.Component);var me=function(){return Object(h.jsxs)(be,{children:[Object(h.jsxs)("div",{className:"app",children:[Object(h.jsx)(le,{}),Object(h.jsx)(ie,{})]})," "]})},ve=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,52)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;r(e),n(e),c(e),o(e),s(e)}))},Oe=r(8),Ce={code:null},ye={countries:[],isFetching:!1,error:""},pe=[],xe=[],_e=Object(Oe.c)({selectedCountry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return{code:t.payload};case g:return Ce;default:return e}},searchedCountries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return Object(u.a)(Object(u.a)({},e),{},{isFetching:!0});case y:return Object(u.a)(Object(u.a)({},e),{},{countries:t.payload,isFetching:!1,error:""});case p:return Object(u.a)(Object(u.a)({},e),{},{countries:[],isFetching:!1,error:t.payload});case x:return Object(u.a)(Object(u.a)({},e),{},{countries:[],isFetching:!1,error:""});default:return e}},favoriteCountries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return[].concat(Object(b.a)(e),[{code:t.payload}]);case N:return e.filter((function(e){return e.code!==t.payload}));default:return e}},countriesCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:var r=e,n=t.payload,c=[].concat(Object(b.a)(r),Object(b.a)(n));return c=k(c),Object(b.a)(c);default:return e}}}),ge=r(23),Se=r.n(ge),Ne=r(24),Fe=Object(Oe.d)(_e,Object(Oe.a)(Ne.a,Se.a));s.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(a.a,{store:Fe,children:Object(h.jsx)(me,{})})}),document.getElementById("root")),ve()}},[[51,1,2]]]);
//# sourceMappingURL=main.3bbb53b7.chunk.js.map